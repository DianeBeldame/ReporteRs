<!DOCTYPE html><html><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Reporters - Word</title><meta name="description" content="Reporters, Word template"><meta name="keywords" content="ReporteRs, Word, template, docx"><link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" media="all" /><link rel="stylesheet" href="css/docs.min.css" type="text/css" media="all" /><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/bootstrap.min.js"></script><script type="text/javascript" src="js/docs.min.js"></script><!--[if lt IE 9]><script src="js/ie8-responsive-file-warning.js"></script><![endif]--><!-- IE10 viewport hack for Surface/desktop Windows 8 bug --><script src="js/ie10-viewport-bug-workaround.js"></script><script src="js/ie-emulation-modes-warning.js"></script><!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries --><!--[if lt IE 9]>  <script src="js/html5shiv.min.js"></script>  <script src="js/respond.min.js"></script><![endif]--><style type="text/css">.tip::before{counter-increment:counter-tip;content:"*";vertical-align:super;}.navbar-default {  background-color: #2C3E50;  border-color: #34495E;}.navbar-default .navbar-brand {  color: #ECF0F1;}.navbar-default .navbar-brand:hover, .navbar-default .navbar-brand:focus {  color: #FFFFFF;}.navbar-default .navbar-text {  color: #ECF0F1;}.navbar-default .navbar-nav > li > a {  color: #ECF0F1;}.navbar-default .navbar-nav > li > a:hover, .navbar-default .navbar-nav > li > a:focus {  color: #FFFFFF;  background-color: #34495E;}.navbar-default .navbar-nav > .active > a, .navbar-default .navbar-nav > .active > a:hover, .navbar-default .navbar-nav > .active > a:focus {  color: #FFFFFF;  background-color: #34495E;}.navbar-default .navbar-nav > .open > a, .navbar-default .navbar-nav > .open > a:hover, .navbar-default .navbar-nav > .open > a:focus {  color: #FFFFFF;  background-color: #34495E;}.navbar-default .navbar-toggle {  border-color: #34495E;}.navbar-default .navbar-toggle:hover, .navbar-default .navbar-toggle:focus {  background-color: #34495E;}.navbar-default .navbar-toggle .icon-bar {  background-color: #34495E;}.navbar-default .navbar-collapse,.navbar-default .navbar-form {  border-color: #ECF0F1;}.navbar-default .navbar-link {  color: #ECF0F1;}.navbar-default .navbar-link:hover {  color: #FFFFFF;}@media (max-width: 767px) {  .navbar-default .navbar-nav .open .dropdown-menu > li > a {    color: #ECF0F1;    background-color: #2C3E50;  }  .navbar-default .navbar-nav .open .dropdown-menu > li > a:hover, .navbar-default .navbar-nav .open .dropdown-menu > li > a:focus {    color: #FFFFFF;    background-color: #34495E;  }  .navbar-default .navbar-nav .open .dropdown-menu > .active > a, .navbar-default .navbar-nav .open .dropdown-menu > .active > a:hover, .navbar-default .navbar-nav .open .dropdown-menu > .active > a:focus {    color: #FFFFFF;    background-color: #34495E;  }}.dropdown-menu > .active > a,.dropdown-menu > .active > a:hover,.dropdown-menu > .active > a:focus {  color: #FFFFFF;  text-decoration: none;  background-color: #34495E;  outline: 0;}.dropdown-menu > li > a,.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus {  color: #34495E;  background-color: #FFFFFF;}.dropdown-menu > li > a:hover,.dropdown-menu > li > a:focus {  text-decoration: none;  background-color: #34495E;  color: #FFFFFF;}</style></head><body><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a><div id="gtooltip"></div><header class="navbar navbar-static-top bs-docs-nav navbar-default" id="top" role="banner"><div class="container"><div class="navbar-header"><button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="./index.html" class="navbar-brand">ReporteRs</a></div><nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation"><ul class="nav navbar-nav"><li><a href="gettingstarted.html">Getting Started</a></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Formatting content<b class="caret"></b></a><ul class="dropdown-menu"><li><a href="formatting_properties.html">formatting Properties</a></li><li role="presentation" class="divider"></li><li><a href="FlexTable.html">FlexTable objects</a></li><li><a href="flextable_examples.html">FlexTable examples</a></li><li role="presentation" class="divider"></li><li><a href="pot_objects.html">pot objects</a></li><li><a href="lists.html">Lists</a></li><li role="presentation" class="divider"></li><li><a href="markdown.html">Markdown</a></li><li role="presentation" class="divider"></li><li><a href="evg.html">Editable vector graphics</a></li></ul></li><li class="dropdown active"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Word<b class="caret"></b></a><ul class="dropdown-menu"><li><a href="word.html">Word</a></li><li role="presentation" class="divider"></li><li><a href="./focus_toc.html">Tables of contents</a></li><li class="active"><a href="./word_template.html">Templates</a></li></ul></li><li><a href="powerpoint.html">PowerPoint</a></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">HTML<b class="caret"></b></a><ul class="dropdown-menu"><li><a href="bsdoc.html">Bootstrap documents</a></li><li><a href="./html_chunks.html">Get HTML chunks</a></li></ul></li><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown">Main functions<b class="caret"></b></a><ul class="dropdown-menu"><li><a href="addFlexTable.html">addFlexTable</a></li><li><a href="addPlot.html">addPlot</a></li><li><a href="addParagraph.html">addParagraph</a></li><li><a href="addImage.html">addImage</a></li><li><a href="addTitle.html">addTitle</a></li><li><a href="addRScript.html">addRScript</a></li><li><a href="writeDoc.html">writeDoc</a></li></ul></li></ul></nav></div></header><div class="container bs-docs-container"><div class="row"><div class="col-md-9" role="main"><p style="text-align:center;padding-top:12pt;padding-bottom:12pt;padding-right:12pt;padding-left:12pt;"><span style="font-size:28pt;font-family:Arial;color:#34495E;">Working with Word template file</span></p><p style="text-align:center;padding-top:0pt;padding-bottom:0pt;padding-right:0pt;padding-left:0pt;"><span style="font-size:18pt;font-family:Arial;color:#606060;">Create Word documents based on existing Word documents. </span></p><h1 id="UIDYpZWnjul9G">Overview </h1><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">You can create Word documents based on existing Word documents. The function </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">docx</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> has an optional argument </span><span style="font-size:11pt;font-family:Arial;font-weight:bold;color:#000000;">template</span><span style="font-size:11pt;font-family:Arial;color:#000000;">. </span></p><pre style='text-align:left;'><span style="color:#000000;">doc</span><span style="color:#000000;"> </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000FF;">docx</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#666666;">template</span><span style="color:#000000;"> </span><span style="color:#666666;">=</span><span style="color:#000000;"> </span><span style="font-style:italic;color:#008B8B;">'your_corporate_template.docx'</span><span style="color:#000000;"> </span><span style="color:#000000;">)</span>
</pre><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;font-weight:bold;color:#000000;">It loads in memory your template word document to add content to</span><span style="font-size:11pt;font-family:Arial;color:#000000;">. R outputs will be inserted at the end of that copy (except if you are using bookmarks). </span></p><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">The approach is to use a Word document that contains the layout and main styles of your final document. </span></p><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">If you don't direct ReporteRs to a template file, an empty document will be used (located into the package directory) and you will have a document with its Word styles. </span></p><h2 id="UIDsPSbWMGAF2">Reuse layout and styles </h2><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">You may need to generate docx documents in a particular corporate template (with specific fonts, colour schemes, logos, etc.). </span></p><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">You can edit an existing file in Word, delete the whole content or not, modify paragraph styles, headers, etc., and use it as a template. New reports will have the same layout and styles than the template. </span></p><h2 id="UIDmO0GgTnotZ">Replace content </h2><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">If you want to replace content into existing Word document, you will need to insert bookmarks (used as placeholders to insert contents) into this template. </span></p><h1 id="UIDLEdgPZMTl1">Reuse styles </h1><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">Available styles will be paragraph styles of the base document (e.g. Normal, Title1, etc.). Names of the returned character vector are internal Word labels associated with styles names. </span></p><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">The styles names should only contain letters (from a to z) and numbers. For example, in France the default style named </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">Legend</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> becomes </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">L?gende</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> and is returned as </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">Lgende</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> by the styles R function. The workaround is to create a new style based on </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">L?gende</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> and to name it </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">Legende</span><span style="font-size:11pt;font-family:Arial;color:#000000;">. It will be then a valid name to use with ReporteRs. </span></p><pre style='text-align:left;'><span style="color:#000000;">doc</span><span style="color:#000000;"> </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000FF;">docx</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#666666;">template</span><span style="color:#000000;"> </span><span style="color:#666666;">=</span><span style="color:#000000;"> </span><span style="font-style:italic;color:#008B8B;">'templates/template.docx'</span><span style="color:#000000;"> </span><span style="color:#000000;">)</span>
<span style="color:#0000FF;">styles</span><span style="color:#000000;">(</span><span style="color:#000000;">doc</span><span style="color:#000000;">)</span>
</pre><pre style='text-align:left;'><span style="color:#A7947D;">#           Normal         heading 1         heading 2            header            footer </span>
<span style="color:#A7947D;">#         "Normal"          "Titre1"          "Titre2"          "En-tte"      "Pieddepage" </span>
<span style="color:#A7947D;">#            Title             rcode   figurereference    tablereference </span>
<span style="color:#A7947D;">#          "Titre"           "rcode" "figurereference"  "tablereference" </span>
</pre><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;font-weight:bold;color:#000000;">styles</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> are used by several function, adding text with </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">addParagraph</span><span style="font-size:11pt;font-family:Arial;color:#000000;">, adding titles with </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">addTitle</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> , adding specific TOC with </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">addTOC</span><span style="font-size:11pt;font-family:Arial;color:#000000;">. </span></p><h2 id="UIDnBQQWRmJZX">Paragraphs and styles </h2><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">Function </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">addParagraph</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> has an argument </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">stylename</span><span style="font-size:11pt;font-family:Arial;color:#000000;"> whose value must be one of the names returned by the function </span><span style="font-size:11pt;font-family:Arial;color:#C7254E;background-color:#F9F2F4;">styles</span><span style="font-size:11pt;font-family:Arial;color:#000000;">. </span></p><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">We will use the following file as template: </span><a href="templates/template.docx"><span style="font-size:11pt;font-family:Arial;text-decoration:underline;color:#428BCA;">template.docx</span></a><span style="font-size:11pt;font-family:Arial;color:#000000;"> </span></p><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">The script is producing the following file: </span><a href="examples/styles_demo.docx"><span style="font-size:11pt;font-family:Arial;text-decoration:underline;color:#428BCA;">styles_demo.docx</span></a><span style="font-size:11pt;font-family:Arial;color:#000000;"> </span></p><pre style='text-align:left;'><span style="color:#0000FF;">library</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#000000;">ReporteRs</span><span style="color:#000000;"> </span><span style="color:#000000;">)</span>
</pre><pre style='text-align:left;'><span style="color:#000000;">doc</span><span style="color:#000000;"> </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000FF;">docx</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#666666;">title</span><span style="color:#000000;"> </span><span style="color:#666666;">=</span><span style="color:#000000;"> </span><span style="font-style:italic;color:#008B8B;">'styles - demo'</span><span style="color:#000000;">,</span><span style="color:#000000;"> </span><span style="color:#666666;">template</span><span style="color:#000000;"> </span><span style="color:#666666;">=</span><span style="color:#000000;"> </span><span style="font-style:italic;color:#008B8B;">'templates/template.docx'</span><span style="color:#000000;"> </span><span style="color:#000000;">)</span>
</pre><pre style='text-align:left;'><span style="color:#A7947D;"># display all available styles with their names</span>
<span style="color:#4A444D;">for</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#000000;">stylename</span><span style="color:#000000;"> </span><span style="color:#4A444D;">in</span><span style="color:#000000;"> </span><span style="color:#0000FF;">styles</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#000000;">doc</span><span style="color:#000000;"> </span><span style="color:#000000;">)</span><span style="color:#000000;"> </span><span style="color:#000000;">)</span>
<span style="color:#000000;">  </span><span style="color:#000000;">doc</span><span style="color:#000000;"> </span><span style="color:#000000;">=</span><span style="color:#000000;"> </span><span style="color:#0000FF;">addParagraph</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#000000;">doc</span><span style="color:#000000;">,</span><span style="color:#000000;"> </span><span style="color:#666666;">value</span><span style="color:#000000;"> </span><span style="color:#666666;">=</span><span style="color:#000000;"> </span><span style="color:#000000;">stylename</span><span style="color:#000000;">,</span><span style="color:#000000;"> </span><span style="color:#666666;">stylename</span><span style="color:#000000;"> </span><span style="color:#666666;">=</span><span style="color:#000000;"> </span><span style="color:#000000;">stylename</span><span style="color:#000000;">)</span>
</pre><pre style='text-align:left;'><span style="color:#0000FF;">writeDoc</span><span style="color:#000000;">(</span><span style="color:#000000;"> </span><span style="color:#000000;">doc</span><span style="color:#000000;">,</span><span style="color:#000000;"> </span><span style="color:#666666;">file</span><span style="color:#000000;"> </span><span style="color:#666666;">=</span><span style="color:#000000;"> </span><span style="font-style:italic;color:#008B8B;">'examples/styles_demo.docx'</span><span style="color:#000000;">)</span>
</pre><p style="text-align:center;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:1pt;"><iframe src="http://www.slideshare.net/slideshow/embed_code/37016310" width="600" height="500" ></iframe></p><h2 id="UIDSP4i3m8qWA">Tables of contents and styles </h2><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">Function addTOC has an optional argument stylename. If the argument is specified, a table of contents will be created with entries formatted with the style specified. </span></p><p style="text-align:justify;padding-top:1pt;padding-bottom:1pt;padding-right:1pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#000000;">See </span><a href="./focus_toc.html"><span style="font-size:11pt;font-family:Arial;text-decoration:underline;color:#428BCA;">Tables of contents</span></a><span style="font-size:11pt;font-family:Arial;color:#000000;"> </span></p></div><div class="col-md-3"><div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" role="complementary"><ul class="nav bs-docs-sidenav"><li><a href="#UIDYpZWnjul9G">Overview </a><ul class="nav nav-list"><li><a href="#UIDsPSbWMGAF2">Reuse layout and styles </a></li><li><a href="#UIDmO0GgTnotZ">Replace content </a></li></ul></li><li><a href="#UIDLEdgPZMTl1">Reuse styles </a><ul class="nav nav-list"><li><a href="#UIDnBQQWRmJZX">Paragraphs and styles </a></li><li><a href="#UIDSP4i3m8qWA">Tables of contents and styles </a></li></ul></li></ul><a class="back-to-top" href="#top">Back to top</a></div></div></div></div><footer class="bs-docs-footer" role="contentinfo"><div class="container"><p style="text-align:center;padding-top:0pt;padding-bottom:0pt;padding-right:0pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#BEBEBE;">Maintained by David Gohel.</span></p><p style="text-align:center;padding-top:0pt;padding-bottom:0pt;padding-right:0pt;padding-left:0pt;"><span style="font-size:11pt;font-family:Arial;color:#BEBEBE;">Code licensed under </span><a href="https://gnu.org/licenses/gpl.html"><span style="font-size:11pt;font-family:Arial;color:#428BCA;">GPL-3</span></a><span style="font-size:11pt;font-family:Arial;color:#BEBEBE;">.</span></p><p style="text-align:center;padding-top:0pt;padding-bottom:0pt;padding-right:0pt;padding-left:0pt;"><a href="http://github.com/davidgohel/ReporteRs"><span style="font-size:11pt;font-family:Arial;color:#428BCA;">GitHub</span></a><span style="font-size:11pt;font-family:Arial;color:#BEBEBE;"> - </span><a href="http://github.com/davidgohel/ReporteRs/issues"><span style="font-size:11pt;font-family:Arial;color:#428BCA;">Issues</span></a><span style="font-size:11pt;font-family:Arial;color:#BEBEBE;"> - </span><a href="http://github.com/davidgohel/ReporteRs/releases"><span style="font-size:11pt;font-family:Arial;color:#428BCA;">Releases</span></a><span style="font-size:11pt;font-family:Arial;color:#BEBEBE;"> - </span><a href="http://groups.google.com/group/reporters-package"><span style="font-size:11pt;font-family:Arial;color:#428BCA;">Mailing list</span></a></p></div></footer><script type="text/javascript">$(document).ready(function() {$('.tip').tooltip();});
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-48354045-1', 'auto');
ga('send', 'pageview');</script></body></html>