<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Create Word documents from R</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<script src="libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="libs/tocify-1.9.1/jquery.tocify.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="libs/highlight/default.css"
      type="text/css" />
<script src="libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}

.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation-1.0/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {
    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: "h1.title, .toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.9em;
  padding-left: 5px;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <!-- NOTE: add "navbar-inverse" class for an alternate navbar background -->
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">ReporteRs</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Getting Started</a></li>
        <li><a href="word.html">Word</a></li>
        <li><a href="powerpoint.html">PowerPoint</a></li>
        <li><a href="html.html">HTML</a></li>
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Formatting content<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="formatting_properties.html">formatting Properties</a></li>
            <li role="presentation" class="divider"></li>
            <li><a href="FlexTable.html">FlexTable objects</a></li>
            <li><a href="flextable_examples.html">FlexTable examples</a></li>
            <li role="presentation" class="divider"></li>
            <li><a href="pot_objects.html">pot objects</a></li>
            <li><a href="lists.html">Lists</a></li>
            <li role="presentation" class="divider"></li>
            <li><a href="evg.html">Editable vector graphics</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown">Main functions<b class="caret"></b></a>
          <ul class="dropdown-menu">
            <li><a href="addFlexTable.html">addFlexTable</a></li>
            <li><a href="addImage.html">addImage</a></li>
            <li><a href="addParagraph.html">addParagraph</a></li>
            <li><a href="addPlot.html">addPlot</a></li>
            <li><a href="addTitle.html">addTitle</a></li>
            <li><a href="writeDoc.html">writeDoc</a></li>
          </ul>
        </li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">


<h1 class="title">Create Word documents from R</h1>

</div>


<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<ol style="list-style-type: decimal">
<li><p>Create a docx object</p>
<p>Use the function <code>docx</code> to create an r object representing a Word document. It takes two arguments: a title (appearing only in the Word document properties) and a <strong>template file</strong>. If none is provided, the template file will be an empty document located in the package directory.</p>
<p>When creating a docx object, you use a template file. This file is copied in memory and that copy becomes the document that will be completed with R outputs. Formats and available styles will be those available in the template file.</p></li>
<li><p>Send R outputs into that object</p>
<p>Next, you create the components of your docx file. You create and format text, then insert it using the addParagraph function. You create and insert tables, perhaps merging cells, changing row and column colors or fonts. And, of course, you add plots. Tables, plots and paragraphs formats can be customised with dedicated functions.</p></li>
<li><p>Write the object to a file</p>
<p>Finally, using <code>writeDoc</code>, you write the object into a file with the suffix <code>.docx</code> on your file system.</p></li>
</ol>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<p>Below you can follow this process with a commented R script:</p>
<pre class="r"><code>library( ReporteRs )

# Creation of mydoc, a mydocx object
mydoc &lt;- docx( )

# add into mydoc first 10 lines of iris
mydoc &lt;- addFlexTable( mydoc, FlexTable(iris[1:10,] ) )

# add a page break
mydoc &lt;- addPageBreak( mydoc )

# add text with stylename &quot;Normal&quot; into mydoc 
mydoc &lt;- addParagraph( mydoc, value = &quot;Hello World!&quot;, stylename = &quot;Normal&quot; )

# add a plot into mydoc 
mydoc &lt;- addPlot( mydoc, function() barplot( 1:8, col = 1:8 ) )

# write the doc 
writeDoc( mydoc, file = &quot;files/word/word_simple_example.docx&quot;)</code></pre>
<p>It produces this <a href="./files/word/word_simple_example.docx">document</a>.</p>
</div>
<div id="function-list" class="section level2">
<h2>Function list</h2>
<p>The following functions can only be used when the output format is docx, which you create as described above.</p>
<ul>
<li>Get available styles from the template: <a href="#styles">styles</a></li>
<li>Add a title: <a href="./addTitle.html">addTitle</a></li>
<li>Add a table: addFlexTable - see <a href="./FlexTable.html">FlexTable</a> and <a href="./addFlexTable.html">addFlexTable</a></li>
<li>Add plots: addPlot (see <a href="./addPlot.html">addPlot</a> and <a href="./evg.html">Editable Vector Graphics</a> )</li>
<li>Add external images: addImage (see <a href="./addImage.html">External images</a> )</li>
<li>add section (i.e for landscape, columns): <a href="#section">addSection</a></li>
<li>Add syntax highlighted R code: addRScript</li>
<li>Add paragraphs of text: <a href="./addParagraph.html">addParagraph</a></li>
<li>Add markdown: <a href="./markdown.html">addMarkdown</a></li>
<li>Add a table of contents: <a href="#table_of_contents">addTOC</a></li>
<li>Add a page break: <a href="#page_breaks">addPageBreak</a></li>
<li>Delete a content located after a bookmark: <a href="#delete_content">deleteBookmarkNextContent</a></li>
<li>Write the document into a file: <a href="./writeDoc.html">writeDoc</a></li>
<li>Create a <code>Footnote</code> to add into a <a href="pot_objects.html#footnotes">pot</a> object.</li>
</ul>
</div>
<div id="templates" class="section level2">
<h2>Templates</h2>
<p>You may need to generate docx documents in a particular corporate template (with specific fonts, colour schemes, logos, etc.). The function <code>docx</code> has an optional argument <strong>template</strong>, it lets you create documents based on existing Word documents.</p>
<p>If you don’t direct ReporteRs to a template file, an empty document will be used (located into the package directory) and you will have a document with its Word styles.</p>
<p><strong>It loads in memory your template word document to add content to</strong>. R outputs will be inserted at the end of that copy (except if you are using bookmarks). The approach is to use a Word document that contains the layout and main styles of your final document. You can edit an existing file in Word, delete the whole content or not, modify paragraph styles, headers, etc., and use it as a template. New reports will have the same layout and styles than the template.</p>
<pre class="r"><code># use D:/docs/template/my_corporate_template.docx as template
doc &lt;- docx(template = &#39;D:/docs/template/my_corporate_template.docx&#39;)

# use default template
doc &lt;- docx()</code></pre>
<p>If template content should be deleted, use the argument <code>empty_template=TRUE</code> when calling <code>docx</code> function:</p>
<pre class="r"><code>doc &lt;- docx(template = &#39;D:/docs/template/my_corporate_template.docx&#39;, empty_template = TRUE)</code></pre>
</div>
<div id="styles" class="section level2">
<h2>Styles</h2>
<p>Available styles will be paragraph styles of the base document (e.g. Normal, Title1, etc.). Names of the returned character vector are internal Word labels associated with styles names.</p>
<pre class="r"><code>doc &lt;- docx()
styles( doc )</code></pre>
<pre><code>##                    Normal                 heading 1 
##                  &quot;Normal&quot;                  &quot;Titre1&quot; 
##                 heading 2                 heading 3 
##                  &quot;Titre2&quot;                  &quot;Titre3&quot; 
##                 heading 4                 heading 5 
##                  &quot;Titre4&quot;                  &quot;Titre5&quot; 
##                 heading 6                 heading 7 
##                  &quot;Titre6&quot;                  &quot;Titre7&quot; 
##                 heading 8                 heading 9 
##                  &quot;Titre8&quot;                  &quot;Titre9&quot; 
##                     Title                  Subtitle 
##                   &quot;Titre&quot;              &quot;Sous-titre&quot; 
##                     Quote             Intense Quote 
##                &quot;Citation&quot;         &quot;Citationintense&quot; 
##                   caption               TOC Heading 
##                  &quot;Lgende&quot; &quot;En-ttedetabledesmatires&quot; 
##                No Spacing            List Paragraph 
##          &quot;Sansinterligne&quot;       &quot;Paragraphedeliste&quot; 
##               rPlotLegend                    header 
##             &quot;rPlotLegend&quot;                  &quot;En-tte&quot; 
##                    footer                    Titre1 
##              &quot;Pieddepage&quot;                 &quot;Titre10&quot; 
##                BulletList                    Titre2 
##              &quot;BulletList&quot;                 &quot;Titre20&quot; 
##                  TitleDoc                rRawOutput 
##                &quot;TitleDoc&quot;              &quot;rRawOutput&quot; 
##              rTableLegend 
##            &quot;rTableLegend&quot;</code></pre>
<p><em>When using a template, styles names of the template should only contain letters (from a to z) and numbers. For example, in France the default style named <code>Legend</code> becomes <code>L?gende</code> and is returned as <code>Lgende</code> by the styles R function. The workaround is to create a new style based on <code>L?gende</code> and to name it <code>Legende</code>. It will be then a valid name to use with ReporteRs.</em></p>
<p><strong>styles</strong> are used by several function, adding text with <code>addParagraph</code>, adding titles with <code>addTitle</code> , adding specific TOC with <code>addTOC</code>.</p>
<div id="paragraphs-and-styles" class="section level3">
<h3>Paragraphs and styles</h3>
<p>Function <code>addParagraph</code> has an argument <code>stylename</code> whose value must be one of the names returned by the function <code>styles</code>.</p>
<p>We will use the following file as template: <a href="./files/word/template.docx">template.docx</a></p>
<pre class="r"><code>doc &lt;- docx( template = &#39;files/word/template.docx&#39; )

# display all available styles with their names
for( stylename in styles( doc ) )
  doc &lt;- addParagraph( doc, value = stylename, stylename = stylename)

writeDoc( doc, file = &#39;files/word/styles_demo.docx&#39;)</code></pre>
<p>It produces this <a href="./files/word/styles_demo.docx">document</a>.</p>
</div>
</div>
<div id="replace-content" class="section level2">
<h2>Replace content</h2>
<p>You can replace Word bookmarks by tables, paragraphs and plots.</p>
<p>Work bookmarks can be used to define a named location in your document. Read MS documentation about bookmark <a href="http://www.wikihow.com/Add-a-Bookmark-in-Microsoft-Word">here</a>.</p>
<p>Functions <strong>addFlexTable, addPlot, addParagraph and addImage</strong> can send respective outputs into theses bookmarks. These functions have an optional argument <code>bookmark</code>. If the argument is used, content (plots, paragraphs or images) will <strong>replace the whole paragraph containing the bookmark</strong>.</p>
<hr />
<blockquote>
<p>Behavior is ifferent for tables: <strong>tables are added AFTER</strong> the paragraph that contains the bookmark.</p>
</blockquote>
<blockquote>
<p>A Word table is an object you can add to your document. Paragraphs and tables are different containers ; a Word table contains paragraphs but is not a paragraph object. Because Word bookmarks are located in paragraphs, it is not possible to bookmark a table.</p>
</blockquote>
<hr />
<blockquote>
<p>If a table contains a bookmark used to add another table (therefore creating a <strong>nested table</strong>), the table header won’t be repeated if the cell is displayed on several pages. ReporteRs expects a bookmark to be in a single paragraph to be used with <code>addFlexTable</code>. However, Word is not able to repeat header cells if table is nested in another table.</p>
</blockquote>
<hr />
<div id="example-1" class="section level3">
<h3>Example</h3>
<p>We will use the following file as template: <a href="./files/word/word_bookmark_template.docx">word_bookmark_template.docx</a></p>
<pre class="r"><code>library( ReporteRs )
library( ggplot2 )

mydoc &lt;- docx( template = &quot;files/word/word_bookmark_template.docx&quot; )

# replace bookmarks &#39;AUTHOR&#39; and &#39;REVIEWER&#39;
# by dummy values
mydoc &lt;- addParagraph( mydoc
  , value = c( &quot;James Sonny Crockett&quot;, &quot;Ricardo Rico Tubbs&quot; )   
    , stylename = &quot;small&quot;
    , bookmark = &quot;AUTHOR&quot; )
mydoc &lt;- addParagraph( mydoc
    , value = c( &quot;Martin Marty Castillo&quot; )  
    , stylename = &quot;small&quot;
    , bookmark = &quot;REVIEWER&quot; )


MyFTable = FlexTable( data = mtcars[1:10, ], add.rownames=TRUE )

# replace bookmarks &#39;DATA&#39;
mydoc &lt;- addFlexTable( mydoc, MyFTable, bookmark = &quot;DATA&quot; )

myplot1 = qplot(Sepal.Length, Petal.Length, data = iris, color = Species, 
                size = Petal.Width, alpha = I(0.7) )

# replace bookmarks &#39;PLOT&#39;
mydoc &lt;- addPlot( mydoc, fun = print, x = myplot1, bookmark = &quot;PLOT&quot; )

writeDoc( mydoc, file = &quot;files/word/word_replacement.docx&quot;)</code></pre>
<p>It produces this <a href="./files/word/word_replacement.docx">document</a>.</p>
</div>
<div id="declare-bookmark-in-word" class="section level3">
<h3>Declare bookmark in Word</h3>
<p>To add a bookmark that ReporteRs will use later, you have to add the bookmark <strong>on a portion of a text in a paragraph</strong>. No matter what the selected text is, ReporteRs will replace the whole paragraph.</p>
<p>To make it work properly, <strong>do not add the bookmark on the whole paragraph</strong> but rather in the paragraph (e.g. select the first word of the paragraph and bookmark it).</p>
<p>This operation is to be done in Word, by editing the template of the document.</p>
<p>Below an example that will not work (bookmark brackets are on the whole paragraph):</p>
<p><img src="figure/bookmark_wrong.png" alt="bookmark_wrong" /></p>
<p>Below an example that will work (bookmark brackets are not on the whole paragraph):</p>
<p><img src="figure/bookmark_right.png" alt="bookmark_right" /></p>
</div>
</div>
<div id="specific-functions" class="section level2">
<h2>Specific functions</h2>
<div id="table-of-contents" class="section level3">
<h3>Table of contents</h3>
<p>Insert a table of contents with function <code>addTOC</code>.</p>
<pre class="r"><code>doc &lt;- addTOC(doc)</code></pre>
<blockquote>
<p>When added, a TOC will make Word to pop-up a message-box asking you if you want to update TOC entries. <strong>This is not an error</strong>, you should click ‘Yes’ to update TOC entries.</p>
</blockquote>
<div id="customized-table-of-contents" class="section level4">
<h4>Customized table of contents</h4>
<p>Add a customized table of contents with the argument <code>stylename</code>. If used, a table of contents will be created containing entries formatted with specified styles.</p>
<pre class="r"><code># add a table of all paragraphs with style &#39;stylename&#39;
doc &lt;- addTOC( doc, stylename = &#39;stylename&#39; )</code></pre>
<p><strong>Example: Add a list of figures and a list of tables</strong></p>
<p>In the following example, style <code>figurereference</code> is used as style of paragraphs following graphics, as a <strong>caption</strong> for plots. Style <code>tablereference</code> is used as style of paragraphs following table, as a <strong>caption</strong> for tables.</p>
<p>These styles are available in the template file <em>templates/template_toc.docx</em>.</p>
<p>We will:</p>
<ol style="list-style-type: decimal">
<li>add a table of content</li>
<li>add a table of figures</li>
<li>add a table of tables</li>
</ol>
<p>We will use the following file as template: <a href="./files/word/template_toc.docx">template_toc.docx</a></p>
<pre class="r"><code>library( ReporteRs )
library( ggplot2 )
library(magrittr)

myplot1 &lt;- qplot(Sepal.Length, Petal.Length, 
  data = iris, color = Species, 
  size = Petal.Width, alpha = I(0.7))
myplot2 &lt;- qplot(mpg, wt, data = mtcars, colour = cyl )

# Create a new document
mydoc &lt;- docx( template = &quot;files/word/template_toc.docx&quot; )

# display available styles
styles( mydoc )</code></pre>
<pre><code>##            Normal         heading 1         heading 2            header 
##          &quot;Normal&quot;          &quot;Titre1&quot;          &quot;Titre2&quot;          &quot;En-tte&quot; 
##            footer             Title             rcode   figurereference 
##      &quot;Pieddepage&quot;           &quot;Titre&quot;           &quot;rcode&quot; &quot;figurereference&quot; 
##    tablereference 
##  &quot;tablereference&quot;</code></pre>
<pre class="r"><code>mydoc &lt;- mydoc %&gt;% addTitle( &quot;Table of contents&quot;, level =  1 ) %&gt;% 
  addTOC( ) %&gt;% # add a table of content
  addPageBreak() # add a page break

mydoc &lt;- mydoc %&gt;% addTitle( &quot;List of graphics&quot;, level =  1 ) %&gt;% 
  addTOC( stylename = &quot;figurereference&quot; ) %&gt;% 
  addTitle( &quot;List of tables&quot;, level =  1 ) %&gt;% 
  addTOC( stylename = &quot;tablereference&quot; )

mydoc &lt;- addPageBreak( mydoc )

mydoc &lt;- mydoc %&gt;% addTitle( &quot;iris outputs&quot;, level =  1 ) %&gt;% 
  addTitle( &quot;Plot&quot;, level =  2 ) %&gt;% 
  addPlot(function( ) print( myplot1 ) ) %&gt;% 
  addParagraph( value = &quot;iris plot&quot;, 
    stylename = &quot;figurereference&quot;) %&gt;%  # Add a legend below the plot
  addTitle( &quot;Table&quot;, level =  2 ) %&gt;% 
  addFlexTable( vanilla.table( head( iris ) ) ) %&gt;%
  addParagraph( value = &quot;iris table&quot;, 
    stylename = &quot;tablereference&quot;) # Add a legend below the table

mydoc &lt;- mydoc %&gt;% addTitle( &quot;mtcars outputs&quot;, level =  1 ) %&gt;% 
  addTitle( &quot;Plot&quot;, level =  2 ) %&gt;% 
  addPlot(function( ) print( myplot2 ) ) %&gt;% 
  addParagraph( value = &quot;mtcars plot&quot;, 
    stylename = &quot;figurereference&quot;) %&gt;%  # Add a legend below the plot
  addTitle( &quot;Table&quot;, level =  2 ) %&gt;% 
  addFlexTable( vanilla.table( head( mtcars ) ) ) %&gt;%
  addParagraph( value = &quot;mtcars table&quot;, 
    stylename = &quot;tablereference&quot;) # Add a legend below the table

writeDoc( mydoc, file = &quot;files/word/toc_demo.docx&quot;)</code></pre>
<p>It produces this <a href="./files/word/toc_demo.docx">document</a>.</p>
</div>
</div>
<div id="page-breaks" class="section level3">
<h3>Page breaks</h3>
<p>Insert a page break with function addPageBreak</p>
<pre class="r"><code>doc &lt;- addPageBreak(doc)</code></pre>
</div>
<div id="delete-content" class="section level3">
<h3>Delete content</h3>
<p>Function <code>deleteBookmarkNextContent</code> deletes the content just after a bookmark.</p>
<p>It has to be used when ‘refreshing’ a table in a docx file.</p>
<p>AddFlexTable uses <code>bookmark</code> as the <strong>location preceding</strong> the destination of the <code>FlexTable</code>.</p>
<p>If a document’s table of content needs to be updated, it has to be done in two steps:</p>
<ol style="list-style-type: decimal">
<li>suppress the previously added table with <strong>deleteBookmarkNextContent</strong></li>
<li>insert new table with <strong>AddFlexTable</strong>.</li>
</ol>
</div>
<div id="section" class="section level3">
<h3>Section</h3>
<p>Function <code>addSection</code> lets you add a section and change document orientation and split new content along 2 or more columns.</p>
<p>The function requires you to add a section before and after the item(s) that you want to be on a landscape and/or multicolumns mode page.</p>
<pre class="r"><code>library(magrittr)

doc &lt;- docx()

doc &lt;- addSection( doc, landscape = TRUE) %&gt;% 
  addFlexTable( vanilla.table(mtcars)) %&gt;% 
  addSection()

doc &lt;- addSection( doc, ncol = 2, landscape = TRUE) %&gt;% 
  addParagraph( &quot;My text on column 1&quot;, stylename = &quot;Normal&quot; ) %&gt;% 
  addColumnBreak( ) %&gt;% 
  addPlot(fun = function() barplot(1:5), width = 3, height = 3 ) %&gt;% 
  addSection( )

writeDoc( doc, file = &quot;files/word/landscape.docx&quot;)</code></pre>
<p>It produces this <a href="./files/word/landscape.docx">document</a>.</p>
</div>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48354045-1', 'auto');
  ga('send', 'pageview');
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
